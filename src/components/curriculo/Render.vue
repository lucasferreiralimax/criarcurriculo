<template lang="pug">
  section.render(v-if="user.name" :class="{ 'viewfixed' : viewfixed }")
    .view
      .content(:class="{ 'viewless' : viewless, 'viewblocked' : viewblocked, 'viewend' : viewend }" @click="viewMore")
        label.figure(for="GET-photo" v-if="user.photo")
          figure
            img#photo(:src="user.photo" :alt="user.name" width="auto")
          button.btn.small(type="button" @click="rotateFigure" :aria-label="$t('aria-label.photo_rotate')")
            svg(xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 481.95 481.95")
              path(d="M331.5 114.75L216.75 0v79.05C117.3 91.8 38.25 175.95 38.25 280.5s79.05 188.7 178.5 201.45v-51C145.35 418.2 89.25 357 89.25 280.5s56.1-137.7 127.5-150.45v99.45L331.5 114.75zM443.7 255c-5.101-35.7-17.851-68.85-40.8-99.45l-35.7 35.7c12.75 20.4 22.95 40.8 25.5 63.75h51zM267.75 430.95v51c35.7-5.101 68.85-17.851 99.45-40.8l-35.7-35.7c-20.4 12.75-40.8 22.95-63.75 25.5zm99.45-61.2l35.7 35.7c22.949-30.601 38.25-63.75 40.8-99.45h-51c-2.55 22.95-12.75 43.35-25.5 63.75z")
        .info
          label(for="GET-name")
            h1 {{ user.name }}
          p(v-if="user.maritalstatus") {{ user.maritalstatus }}
            span(v-if="user.maritalstatus")  {{ user.age }} {{ user.age ? 'anos ' : '' }}
          p(v-if="user.end.logradouro")
            svg.icon-location(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="13")
              path(d="M256 0C153.755 0 70.573 83.182 70.573 185.426c0 126.888 165.939 313.167 173.004 321.035 6.636 7.391 18.222 7.378 24.846 0 7.065-7.868 173.004-194.147 173.004-321.035C441.425 83.182 358.244 0 256 0zm0 278.719c-51.442 0-93.292-41.851-93.292-93.293S204.559 92.134 256 92.134s93.291 41.851 93.291 93.293-41.85 93.292-93.291 93.292z")
            | {{ user.end.logradouro }}, {{ user.addressNumber }}{{ user.addressNumber ? ',' : '' }} {{ user.end.localidade }} - {{ user.end.uf }} - {{ user.cep }}
        hr
        p(v-if="user.travel") {{ user.travel ? $t('form.travel') : '' }}
        label(for="GET-about")
          h2(v-if="user.about") {{ $t('form.about_me') }}
          p(v-if="user.about")
            pre {{ user.about }}
        h2(v-if="user.coursers[0]") {{ $t('form.cademy')}}
        .coursers(v-for="(course, key, index) in user.coursers")
          p(v-if="course.formation.now") {{ course.formation.now ? $t('form.cademy_now') : '' }}
          label(for="GET-about")
            h3(v-if="course.formation.school") <!-- {{ $t('form.school') }}: -->
              svg.icon-course(viewBox="0 -35 512 512" width="20" xmlns="http://www.w3.org/2000/svg")
                path(d="M512 135.5c0-13.242-8.941-25.305-24.531-33.102L302.074 9.703C289.56 3.445 273.195 0 255.996 0c-17.203 0-33.57 3.445-46.086 9.703L24.531 102.398C8.941 110.195 0 122.262 0 135.504s8.941 25.305 24.531 33.098l40.383 20.191V293.98c0 29.883 20.934 63.758 47.66 77.125l97.348 48.668c12.922 6.461 29.5 9.692 46.082 9.692s33.164-3.23 46.086-9.692l97.332-48.668c26.726-13.367 47.664-47.242 47.664-77.125V188.797l34.91-17.457v254.707c0 8.285 6.715 15 15 15s15-6.715 15-15V135.57c0-.023.004-.047.004-.07zm-481.965 0c.34-.805 2.25-3.441 7.914-6.273l185.38-92.688C231.636 32.383 243.542 30 255.995 30c12.45 0 24.356 2.383 32.664 6.535L456.59 120.5H312.328c-7.515-20.387-29.922-35.215-56.332-35.215-32.539 0-59.02 22.528-59.02 50.215 0 27.691 26.477 50.219 59.02 50.219 26.41 0 48.82-14.832 56.332-35.219h144.27l-167.926 83.96c-8.313 4.157-20.215 6.54-32.664 6.54h-.004c-12.45 0-24.356-2.383-32.664-6.535L37.95 141.77c-5.665-2.833-7.575-5.465-7.915-6.27zm254.985 0c0 10.96-13.29 20.219-29.024 20.219-15.726 0-29.02-9.258-29.02-20.219 0-10.957 13.294-20.215 29.02-20.215 15.734 0 29.024 9.258 29.024 20.215zm132.066 158.48c0 18.512-14.524 42.012-31.082 50.293l-97.332 48.668c-17.402 8.7-47.934 8.7-65.332 0l-97.348-48.668c-16.555-8.28-31.082-31.78-31.082-50.293v-90.187l115.012 57.504C222.437 267.555 238.8 271 256.004 271s33.566-3.45 46.082-9.707l115-57.5zm0 0")
              |{{ course.formation.school }}
          label(for="GET-about")
            p(v-if="course.formation.name") {{ course.formation.name }}
          label(for="GET-about")
            p(v-if="course.formation.about")
              pre {{ $t('form.activities') }}: {{ course.formation.about }}
          label(for="GET-about")
            p.date(v-if="course.formation.data_start")
              svg.icon-date(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.634 511.634" width="13")
                path(d="M482.513 83.942c-7.225-7.233-15.797-10.85-25.694-10.85h-36.541v-27.41c0-12.56-4.477-23.315-13.422-32.261C397.906 4.475 387.157 0 374.591 0h-18.268c-12.565 0-23.318 4.475-32.264 13.422-8.949 8.945-13.422 19.701-13.422 32.261v27.41h-109.63v-27.41c0-12.56-4.475-23.315-13.422-32.261C178.64 4.475 167.886 0 155.321 0H137.05c-12.562 0-23.317 4.475-32.264 13.422-8.945 8.945-13.421 19.701-13.421 32.261v27.41H54.823c-9.9 0-18.464 3.617-25.697 10.85-7.233 7.232-10.85 15.8-10.85 25.697v365.453c0 9.89 3.617 18.456 10.85 25.693 7.232 7.231 15.796 10.849 25.697 10.849h401.989c9.897 0 18.47-3.617 25.694-10.849 7.234-7.234 10.852-15.804 10.852-25.693V109.639c-.001-9.9-3.615-18.464-10.845-25.697zM137.047 475.088H54.823v-82.23h82.224v82.23zm0-100.498H54.823v-91.358h82.224v91.358zm0-109.639H54.823v-82.223h82.224v82.223zm-6.42-130.618c-1.809-1.809-2.712-3.946-2.712-6.423V45.686c0-2.474.903-4.617 2.712-6.423 1.809-1.809 3.946-2.712 6.423-2.712h18.271c2.474 0 4.617.903 6.423 2.712 1.809 1.807 2.714 3.949 2.714 6.423v82.224c0 2.478-.909 4.615-2.714 6.423-1.807 1.809-3.946 2.712-6.423 2.712H137.05c-2.474.001-4.614-.903-6.423-2.712zm116.056 340.755h-91.365v-82.23h91.365v82.23zm0-100.498h-91.365v-91.358h91.365v91.358zm0-109.639h-91.365v-82.223h91.365v82.223zm109.64 210.137h-91.364v-82.23h91.364v82.23zm0-100.498h-91.364v-91.358h91.364v91.358zm0-109.639h-91.364v-82.223h91.364v82.223zm-6.427-130.618c-1.807-1.809-2.707-3.946-2.707-6.423V45.686c0-2.474.9-4.617 2.707-6.423 1.808-1.809 3.949-2.712 6.427-2.712h18.268c2.478 0 4.617.903 6.427 2.712 1.808 1.807 2.707 3.949 2.707 6.423v82.224c0 2.478-.903 4.615-2.707 6.423-1.807 1.809-3.949 2.712-6.427 2.712h-18.268c-2.477.001-4.626-.903-6.427-2.712zm106.916 340.755h-82.228v-82.23h82.228v82.23zm0-100.498h-82.228v-91.358h82.228v91.358zm0-109.639h-82.228v-82.223h82.228v82.223z")
              | {{ course.formation.data_start | dateFormat }} {{ course.formation.data_end ? $t('form.to') : '' }} {{ course.formation.data_end | dateFormat }}
          hr
        h2(v-if="user.exps[0]") {{ $t('form.exp')}}
        .experiencies(v-for="(exp, key, index) in user.exps")
          p(v-if="exp.experience.now") {{ exp.experience.now ? $t('form.exp_now') : '' }}
          h3(v-if="exp.experience.name") <!-- {{ $t('form.company') }}: -->
            svg.icon-experience(viewBox="0 -31 512 512" xmlns="http://www.w3.org/2000/svg" width="20")
              path(d="M497.094 60.004c-.031 0-.063-.004-.094-.004H361V45c0-24.813-20.188-45-45-45H196c-24.813 0-45 20.188-45 45v15H15C6.648 60 0 66.844 0 75v330c0 24.813 20.188 45 45 45h422c24.813 0 45-20.188 45-45V75.316v-.058c-.574-9.852-6.633-15.2-14.906-15.254zM181 45c0-8.27 6.73-15 15-15h120c8.27 0 15 6.73 15 15v15H181zm295.188 45l-46.583 139.742A14.975 14.975 0 0 1 415.38 240H331v-15c0-8.285-6.715-15-15-15H196c-8.285 0-15 6.715-15 15v15H96.621a14.975 14.975 0 0 1-14.226-10.258L35.813 90zM301 240v30h-90v-30zm181 165c0 8.27-6.73 15-15 15H45c-8.27 0-15-6.73-15-15V167.434l23.934 71.796A44.935 44.935 0 0 0 96.62 270H181v15c0 8.285 6.715 15 15 15h120c8.285 0 15-6.715 15-15v-15h84.379a44.935 44.935 0 0 0 42.687-30.77L482 167.434zm0 0")
            | {{ exp.experience.name }}
          p(v-if="exp.experience.work") {{ $t('form.office') }}: {{ exp.experience.work }}
          p(v-if="exp.experience.about")
            pre(v-html="exp.experience.about") <!-- {{ exp.experience.about }} -->
          p.date(v-if="exp.experience.data_start && exp.experience.now")
            svg.icon-date(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.634 511.634" width="13")
              path(d="M482.513 83.942c-7.225-7.233-15.797-10.85-25.694-10.85h-36.541v-27.41c0-12.56-4.477-23.315-13.422-32.261C397.906 4.475 387.157 0 374.591 0h-18.268c-12.565 0-23.318 4.475-32.264 13.422-8.949 8.945-13.422 19.701-13.422 32.261v27.41h-109.63v-27.41c0-12.56-4.475-23.315-13.422-32.261C178.64 4.475 167.886 0 155.321 0H137.05c-12.562 0-23.317 4.475-32.264 13.422-8.945 8.945-13.421 19.701-13.421 32.261v27.41H54.823c-9.9 0-18.464 3.617-25.697 10.85-7.233 7.232-10.85 15.8-10.85 25.697v365.453c0 9.89 3.617 18.456 10.85 25.693 7.232 7.231 15.796 10.849 25.697 10.849h401.989c9.897 0 18.47-3.617 25.694-10.849 7.234-7.234 10.852-15.804 10.852-25.693V109.639c-.001-9.9-3.615-18.464-10.845-25.697zM137.047 475.088H54.823v-82.23h82.224v82.23zm0-100.498H54.823v-91.358h82.224v91.358zm0-109.639H54.823v-82.223h82.224v82.223zm-6.42-130.618c-1.809-1.809-2.712-3.946-2.712-6.423V45.686c0-2.474.903-4.617 2.712-6.423 1.809-1.809 3.946-2.712 6.423-2.712h18.271c2.474 0 4.617.903 6.423 2.712 1.809 1.807 2.714 3.949 2.714 6.423v82.224c0 2.478-.909 4.615-2.714 6.423-1.807 1.809-3.946 2.712-6.423 2.712H137.05c-2.474.001-4.614-.903-6.423-2.712zm116.056 340.755h-91.365v-82.23h91.365v82.23zm0-100.498h-91.365v-91.358h91.365v91.358zm0-109.639h-91.365v-82.223h91.365v82.223zm109.64 210.137h-91.364v-82.23h91.364v82.23zm0-100.498h-91.364v-91.358h91.364v91.358zm0-109.639h-91.364v-82.223h91.364v82.223zm-6.427-130.618c-1.807-1.809-2.707-3.946-2.707-6.423V45.686c0-2.474.9-4.617 2.707-6.423 1.808-1.809 3.949-2.712 6.427-2.712h18.268c2.478 0 4.617.903 6.427 2.712 1.808 1.807 2.707 3.949 2.707 6.423v82.224c0 2.478-.903 4.615-2.707 6.423-1.807 1.809-3.949 2.712-6.427 2.712h-18.268c-2.477.001-4.626-.903-6.427-2.712zm106.916 340.755h-82.228v-82.23h82.228v82.23zm0-100.498h-82.228v-91.358h82.228v91.358zm0-109.639h-82.228v-82.223h82.228v82.223z")
            | {{ exp.experience.data_start | dateFormat }}
          p.date(v-if="exp.experience.data_start && !exp.experience.now")
            svg.icon-date(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.634 511.634" width="13")
              path(d="M482.513 83.942c-7.225-7.233-15.797-10.85-25.694-10.85h-36.541v-27.41c0-12.56-4.477-23.315-13.422-32.261C397.906 4.475 387.157 0 374.591 0h-18.268c-12.565 0-23.318 4.475-32.264 13.422-8.949 8.945-13.422 19.701-13.422 32.261v27.41h-109.63v-27.41c0-12.56-4.475-23.315-13.422-32.261C178.64 4.475 167.886 0 155.321 0H137.05c-12.562 0-23.317 4.475-32.264 13.422-8.945 8.945-13.421 19.701-13.421 32.261v27.41H54.823c-9.9 0-18.464 3.617-25.697 10.85-7.233 7.232-10.85 15.8-10.85 25.697v365.453c0 9.89 3.617 18.456 10.85 25.693 7.232 7.231 15.796 10.849 25.697 10.849h401.989c9.897 0 18.47-3.617 25.694-10.849 7.234-7.234 10.852-15.804 10.852-25.693V109.639c-.001-9.9-3.615-18.464-10.845-25.697zM137.047 475.088H54.823v-82.23h82.224v82.23zm0-100.498H54.823v-91.358h82.224v91.358zm0-109.639H54.823v-82.223h82.224v82.223zm-6.42-130.618c-1.809-1.809-2.712-3.946-2.712-6.423V45.686c0-2.474.903-4.617 2.712-6.423 1.809-1.809 3.946-2.712 6.423-2.712h18.271c2.474 0 4.617.903 6.423 2.712 1.809 1.807 2.714 3.949 2.714 6.423v82.224c0 2.478-.909 4.615-2.714 6.423-1.807 1.809-3.946 2.712-6.423 2.712H137.05c-2.474.001-4.614-.903-6.423-2.712zm116.056 340.755h-91.365v-82.23h91.365v82.23zm0-100.498h-91.365v-91.358h91.365v91.358zm0-109.639h-91.365v-82.223h91.365v82.223zm109.64 210.137h-91.364v-82.23h91.364v82.23zm0-100.498h-91.364v-91.358h91.364v91.358zm0-109.639h-91.364v-82.223h91.364v82.223zm-6.427-130.618c-1.807-1.809-2.707-3.946-2.707-6.423V45.686c0-2.474.9-4.617 2.707-6.423 1.808-1.809 3.949-2.712 6.427-2.712h18.268c2.478 0 4.617.903 6.427 2.712 1.808 1.807 2.707 3.949 2.707 6.423v82.224c0 2.478-.903 4.615-2.707 6.423-1.807 1.809-3.949 2.712-6.427 2.712h-18.268c-2.477.001-4.626-.903-6.427-2.712zm106.916 340.755h-82.228v-82.23h82.228v82.23zm0-100.498h-82.228v-91.358h82.228v91.358zm0-109.639h-82.228v-82.223h82.228v82.223z")
            | {{ exp.experience.data_start | dateFormat }} {{ exp.experience.data_end ? $t('form.to') : '' }} {{ exp.experience.data_end | dateFormat}}
          hr
        h2(v-if="user.telephones.length || user.emails.length || user.sites.length") {{ $t('form.contact') }}
        p(v-if="user.telephones" v-for="(telephone, key, index) in user.telephones") <!-- {{ $t('form.phone') }}: -->
          svg.icon-phone(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 348.077 348.077" width="13")
            path(d="M340.273 275.083l-53.755-53.761c-10.707-10.664-28.438-10.34-39.518.744l-27.082 27.076a792.327 792.327 0 0 1-5.344-2.973c-17.102-9.476-40.509-22.464-65.14-47.113-24.704-24.701-37.704-48.144-47.209-65.257-1.003-1.813-1.964-3.561-2.913-5.221l18.176-18.149 8.936-8.947c11.097-11.1 11.403-28.826.721-39.521L73.39 8.194c-10.682-10.68-28.421-10.356-39.518.744l-15.15 15.237.414.411c-5.08 6.482-9.325 13.958-12.484 22.02C3.74 54.28 1.927 61.603 1.098 68.941-6 127.785 20.89 181.564 93.866 254.541c100.875 100.868 182.167 93.248 185.674 92.876 7.638-.913 14.958-2.738 22.397-5.627 7.992-3.122 15.463-7.361 21.941-12.43l.331.294 15.348-15.029c11.074-11.098 11.393-28.83.716-39.542z")
          | {{ telephone }}
        p(v-if="user.emails" v-for="(email, key, index) in user.emails") <!-- {{ $t('form.email') }}: -->
          svg.icon-email(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="13")
            path(d="M467 61H45C20.218 61 0 81.196 0 106v300c0 24.72 20.128 45 45 45h422c24.72 0 45-20.128 45-45V106c0-24.72-20.128-45-45-45zm-6.214 30L256.954 294.833 51.359 91h409.427zM30 399.788V112.069l144.479 143.24L30 399.788zM51.213 421l144.57-144.57 50.657 50.222c5.864 5.814 15.327 5.795 21.167-.046L317 277.213 460.787 421H51.213zM482 399.787L338.213 256 482 112.212v287.575z")
          | {{ email }}
        p(v-if="user.sites" v-for="(site, key, index) in user.sites")
          svg.icon-site(xmlns="http://www.w3.org/2000/svg" viewBox="0 0 438.536 438.536" width="13")
            path(d="M414.41 24.123C398.333 8.042 378.963 0 356.315 0H82.228C59.58 0 40.21 8.042 24.126 24.123 8.045 40.207.003 59.576.003 82.225v274.084c0 22.647 8.042 42.018 24.123 58.102 16.084 16.084 35.454 24.126 58.102 24.126h274.084c22.648 0 42.018-8.042 58.095-24.126 16.084-16.084 24.126-35.454 24.126-58.102V82.225c-.001-22.649-8.043-42.021-24.123-58.102zm-48.961 204.279c0 7.994-3.717 13.606-11.136 16.844-2.471.951-4.859 1.427-7.139 1.427-5.134 0-9.418-1.811-12.847-5.424l-41.11-41.112-152.453 152.462c-3.621 3.614-7.9 5.425-12.85 5.425-4.952 0-9.235-1.811-12.851-5.425l-29.121-29.126c-3.617-3.61-5.426-7.901-5.426-12.847 0-4.944 1.809-9.229 5.426-12.843l152.462-152.464-41.113-41.112c-5.902-5.52-7.233-12.178-3.999-19.985 3.234-7.421 8.852-11.136 16.846-11.136h137.037c4.948 0 9.232 1.81 12.854 5.428 3.613 3.614 5.421 7.898 5.421 12.847v137.041z")
          | {{ site }}
        hr
</template>

<script>
import { mapState } from 'vuex'
export default {
  name: 'render',
  computed: mapState({ user: state => state.user }),
  created () { window.addEventListener('scroll', this.viewLess) },
  destroyed () { window.removeEventListener('scroll', this.viewLess) },
  data () {
    return {
      viewless: true,
      viewblocked: true,
      viewfixed: false,
      viewend: false
    }
  },
  methods: {
    rotateFigure () {
      let photo = document.querySelector('#photo'),
          transform = photo.style.transform

      switch (transform) {
        case 'rotate(90deg)':
          photo.style.transform = "rotate(180deg)"
          break;
        case 'rotate(180deg)':
          photo.style.transform = "rotate(270deg)"
          break;
        case 'rotate(270deg)':
          photo.style.transform = ""
          break;
        default:
          photo.style.transform = "rotate(90deg)"
          break;
      }
    },
    viewMore () {
      this.viewless = !this.viewless
    },
    viewLess () {
      let el = (document.querySelector('#app').clientHeight - document.querySelector('#app').parentElement.offsetHeight)

      this.viewless = el > window.scrollY
      this.viewend = !(el > window.scrollY)
      this.viewblocked = 300 > window.scrollY


      if (window.innerWidth >= 800) {
        this.viewfixed = 700 < window.scrollY
      } else {
        this.viewfixed = false
      }
    }
  },
  filters: {
    dateFormat (value) {
      if (!value) return ''
      value = value.split("-")
      switch (value[1]) {
        case "01":
          value[1] = "Janeiro"
          break
        case "02":
          value[1] = "Fevereiro"
          break
        case "03":
          value[1] = "MarÃ§o"
          break
        case "04":
          value[1] = "Abril"
          break
        case "05":
          value[1] = "Maio"
          break
        case "06":
          value[1] = "Junho"
          break
        case "07":
          value[1] = "Julho"
          break
        case "08":
          value[1] = "Agosto"
          break
        case "09":
          value[1] = "Setembro"
          break
        case "10":
          value[1] = "Outubro"
          break
        case "11":
          value[1] = "Novembro"
          break
        case "12":
          value[1] = "Dezembro"
          break
      }
      value = value[1] + " de " + value[0]
      return value
    }
  }
}
</script>
